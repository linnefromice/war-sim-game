# Agent Teams 自動起動ルール

タスクの複雑さに応じて Agent Teams の起動を自律的に判断するためのルールです。

---

## 起動判断基準

以下の条件のうち **2つ以上** に該当する場合、Agent Teams の起動を検討してください。

| # | 条件 | 例 |
|---|------|------|
| 1 | **複数ファイルの変更** が必要（3ファイル以上） | フルスタック機能追加、API + UI + テスト |
| 2 | **並列化可能** な独立したサブタスクがある | フロントエンドとバックエンドの同時開発 |
| 3 | **複合ワークフロー** が必要（実装 + テスト + ドキュメント等） | 新機能の設計・実装・テスト・ドキュメント |
| 4 | **高い複雑度** を持つ（アーキテクチャ変更、大規模リファクタリング） | モジュール構造の刷新、認証基盤の差し替え |
| 5 | **多角的な分析** が求められる（コードレビュー + セキュリティ + パフォーマンス） | PR の包括的レビュー |

---

## 起動しない場合

以下に該当する場合は、Agent Teams を起動せず単独で対応してください。

- 単一ファイルの修正（バグ修正、小さな変更）
- 単一の作業で完結する（調査、質問応答、コード説明）
- ユーザーが明示的に単独作業を指示している
- 対話主体のやり取り（設計相談、方針検討）

---

## ワークフロー選択

起動を決定した場合、タスクの性質に応じて適切なワークフローを選択してください。

| ワークフロー | 用途 | 典型的なチーム構成 |
|-------------|------|-------------------|
| `feature` | 新機能開発・機能追加 | implementer × 2-3 + tester |
| `review` | コードレビュー・品質分析 | reviewer + security-reviewer + test-analyzer |
| `debug` | バグ調査・修正 | investigator + fixer + tester |
| `refactor` | リファクタリング・構造改善 | refactorer × 2 + tester |

---

## 実行手順

Agent Teams の起動は以下の 5 ステップで進めてください。

### 1. 判断

タスクを分析し、上記の起動基準に照らして Agent Teams が有効かを判断する。

### 2. 宣言

ユーザーに Agent Teams を起動する理由を簡潔に説明する。

> 例: 「このタスクは API・UI・テストの 3 領域にまたがるため、Agent Teams で並列に進めます。」

### 3. 組成

TeamCreate でチームを作成し、タスクを分割して TaskCreate で登録する。

### 4. 委譲

Task ツールで Teammate を起動し、タスクを割り当てる。リードは調整に専念する。

### 5. 統合

全 Teammate の成果を統合し、ユーザーに結果を報告する。完了後はチームをシャットダウンする。

---

## 注意事項

- **`/team-start` との共存**: ユーザーが `/team-start` コマンドで明示的に起動することも引き続き可能です。自動起動はユーザーの手動起動を置き換えるものではなく、補完するものです。
- **起動前の理由説明**: 必ずユーザーに起動理由を説明してから組成を開始してください。暗黙的にチームを起動してはいけません。
- **ユーザー拒否時の対応**: ユーザーが Agent Teams の使用を拒否した場合は、即座に単独作業に切り替えてください。再度の提案は行わないでください。
